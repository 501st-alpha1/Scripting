#!/bin/bash
# Wrapper script for Ledger-CLI.

basedir="$(pwd)"

validArgs=('disable_payee_check' 'net_excludes')
source loadconf "$basedir" "led.conf" validArgs[@]

# TODO: Make this configurable.
ledger="$basedir/main.ledger"

args="--file $ledger --strict --explicit"

if [ "$disable_payee_check" != 1 ]
then
  args="$args --check-payees"
fi

if [ "$1" == "net" ]
then
  shift

  # TODO: Make included accounts configurable?
  args="$args balance (^Assets ^Liabilities) and not budget"

  # TODO: Allow excluding other accounts.
  for exclude in "${net_excludes[@]}"
  do
    args="$args and not $exclude"
  done
fi

PAGER='' ledger $args "$@"
